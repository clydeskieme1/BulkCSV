<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Google Admin CSV Generator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f8f9fa;
    }
    h2 {
      margin-bottom: 5px;
    }
    textarea {
      width: 100%;
      height: 120px;
      margin-bottom: 20px;
      padding: 8px;
      font-size: 14px;
    }
    button {
      padding: 10px 15px;
      font-size: 16px;
      cursor: pointer;
      background: #007bff;
      border: none;
      color: white;
      border-radius: 5px;
    }
    button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>
  <h1>Google Admin Bulk CSV Generator</h1>
  <p>Paste your data (one entry per line):</p>

  <h2>First Names</h2>
  <textarea id="firstNames"></textarea>

  <h2>Last Names</h2>
  <textarea id="lastNames"></textarea>

  <h2>Passwords</h2>
  <textarea id="passwords"></textarea>

  <h2>Patterns (e.g. name@, namesurname@, admin@)</h2>
  <textarea id="patterns"></textarea>

  <h2>Domains (e.g. sample.com, test.org)</h2>
  <textarea id="domains"></textarea>

  <button onclick="generateCSVs()">Download All CSVs</button>

  <script>
    function generateCSVs() {
      const firstNames = document.getElementById("firstNames").value.trim().split("\n").map(x => x.trim()).filter(Boolean);
      const lastNames = document.getElementById("lastNames").value.trim().split("\n").map(x => x.trim()).filter(Boolean);
      const passwords = document.getElementById("passwords").value.trim().split("\n").map(x => x.trim()).filter(Boolean);
      const patterns = document.getElementById("patterns").value.trim().split("\n").map(x => x.trim()).filter(Boolean);
      const domains = document.getElementById("domains").value.trim().split("\n").map(x => x.trim()).filter(Boolean);

      if (firstNames.length !== lastNames.length || firstNames.length !== passwords.length) {
        alert("Error: First Names, Last Names, and Passwords must all have the same number of rows.");
        return;
      }
      
      if (patterns.length === 0) {
        alert("Error: You must provide at least one pattern.");
        return;
      }

      // Standard Google Admin CSV headers
      const headers = [
        "First Name [Required]","Last Name [Required]","Email Address [Required]","Password [Required]",
        "Password Hash Function [UPLOAD ONLY]","Org Unit Path [Required]","New Primary Email [UPLOAD ONLY]",
        "Recovery Email","Home Secondary Email","Work Secondary Email","Recovery Phone [MUST BE IN THE E.164 FORMAT]",
        "Work Phone","Home Phone","Mobile Phone","Work Address","Home Address","Employee ID","Employee Type",
        "Employee Title","Manager Email","Department","Cost Center","Building ID","Floor Name","Floor Section",
        "Change Password at Next Sign-In","New Status [UPLOAD ONLY]","Advanced Protection Program enrollment"
      ];
      
      const header = headers.join(",");

      // Create a CSV file for each domain
      domains.forEach(domain => {
        const rows = [header];

        // For each pattern, create only one row
        patterns.forEach(pattern => {
          const email = pattern + domain;
          
          // Use the first person's data for all patterns
          const row = [
            firstNames[0],                    // First Name [Required]
            lastNames[0],                     // Last Name [Required]
            email,                            // Email Address [Required]
            passwords[0],                     // Password [Required]
            "",                               // Password Hash Function [UPLOAD ONLY]
            "/",                              // Org Unit Path [Required]
            "",                               // New Primary Email [UPLOAD ONLY]
            "",                               // Recovery Email
            "",                               // Home Secondary Email
            "",                               // Work Secondary Email
            "",                               // Recovery Phone [MUST BE IN THE E.164 FORMAT]
            "",                               // Work Phone
            "",                               // Home Phone
            "",                               // Mobile Phone
            "",                               // Work Address
            "",                               // Home Address
            "",                               // Employee ID
            "",                               // Employee Type
            "",                               // Employee Title
            "",                               // Manager Email
            "",                               // Department
            "",                               // Cost Center
            "",                               // Building ID
            "",                               // Floor Name
            "",                               // Floor Section
            "FALSE",                          // Change Password at Next Sign-In
            "",                               // New Status [UPLOAD ONLY]
            "FALSE"                           // Advanced Protection Program enrollment
          ];
          
          rows.push(row.map(v => `"${v}"`).join(","));
        });

        const csvContent = rows.join("\n");
        const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = `google_admin_import_${domain}.csv`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      });
    }
  </script>
</body>
</html>
